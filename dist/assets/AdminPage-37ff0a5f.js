import{u as Z,s as n,j as e}from"./index-240277ad.js";import{r as i}from"./vendor-447164c8.js";import{q,r as z,s as ee,t as D,u as se,D as te,j as re,X as C}from"./ui-b3a87d38.js";import"./supabase-db24d5d1.js";function oe(){const{signOut:P}=Z(),[c,w]=i.useState("events"),[F,A]=i.useState([]),[M,$]=i.useState([]),[T,U]=i.useState([]),[R,V]=i.useState(!0),[L,m]=i.useState(!1),[a,h]=i.useState(null),[O,u]=i.useState(!1),[r,p]=i.useState(null),[b,B]=i.useState(""),[I,g]=i.useState(!1),[x,y]=i.useState(null),[j,v]=i.useState(null),[k,N]=i.useState(null);i.useEffect(()=>{d()},[]);const d=async()=>{try{const[s,t,l]=await Promise.all([n.from("events").select("*").order("created_at",{ascending:!1}),n.from("resumes").select("*").order("created_at",{ascending:!1}),n.from("team_members").select("*").order("order_index",{ascending:!0})]);if(s.error)throw s.error;if(t.error)throw t.error;if(l.error)throw l.error;A(s.data||[]),$(t.data||[]),U(l.data||[])}catch(s){console.error("Error fetching data:",s)}finally{V(!1)}},W=async s=>{try{const t={title:s.get("title"),date:s.get("date"),location:s.get("location"),description:s.get("description"),image_url:s.get("image_url"),status:s.get("status")};if(a){const{error:l}=await n.from("events").update(t).eq("id",a.id);if(l)throw l}else{const{error:l}=await n.from("events").insert([t]);if(l)throw l}await d(),m(!1),h(null)}catch(t){console.error("Error saving event:",t),alert("Failed to save event")}},X=async s=>{try{let t=(r==null?void 0:r.avatar_url)||"";if(k){const o=k.name.split(".").pop(),f=`avatars/${`${Date.now()}-${Math.random().toString(36).substring(2)}.${o}`}`,{error:E}=await n.storage.from("avatars").upload(f,k);if(E)throw E;const{data:Y}=n.storage.from("avatars").getPublicUrl(f);t=Y.publicUrl}const l={name:s.get("name"),title:s.get("title"),bio:s.get("bio"),avatar_url:t,order_index:parseInt(s.get("order_index"))||0};if(r){const{error:o}=await n.from("team_members").update(l).eq("id",r.id);if(o)throw o}else{const{error:o}=await n.from("team_members").insert([l]);if(o)throw o}await d(),u(!1),p(null),N(null)}catch(t){console.error("Error saving team member:",t),alert("Failed to save team member")}},G=async s=>{if(confirm("Are you sure you want to delete this event?"))try{const{error:t}=await n.from("events").delete().eq("id",s);if(t)throw t;await d()}catch(t){console.error("Error deleting event:",t),alert("Failed to delete event")}},H=async s=>{if(confirm("Are you sure you want to delete this team member?"))try{const{error:t}=await n.from("team_members").delete().eq("id",s);if(t)throw t;await d()}catch(t){console.error("Error deleting team member:",t),alert("Failed to delete team member")}},J=async()=>{if(!(!x||!j))try{const s=j.name.split(".").pop(),l=`blogs/${`${Date.now()}-${x.id}.${s}`}`,{error:o}=await n.storage.from("blogs").upload(l,j);if(o)throw o;const{data:_}=n.storage.from("blogs").getPublicUrl(l),{error:f}=await n.from("events").update({status:"past",recap_file_url:_.publicUrl}).eq("id",x.id);if(f)throw f;await d(),g(!1),y(null),v(null)}catch(s){console.error("Error moving event to past:",s),alert("Failed to move event to past")}},K=(s,t)=>{const l=document.createElement("a");l.href=s,l.download=t,l.target="_blank",document.body.appendChild(l),l.click(),document.body.removeChild(l)},Q=M.filter(s=>s.name.toLowerCase().includes(b.toLowerCase())||s.email.toLowerCase().includes(b.toLowerCase())||s.phone.includes(b)),S=s=>new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return R?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary-600"})}):e.jsx("div",{className:"section-padding",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-900",children:"Admin Dashboard"}),e.jsx("button",{onClick:P,className:"btn-secondary",children:"Sign Out"})]}),e.jsxs("div",{className:"flex space-x-1 mb-8 bg-gray-100 p-1 rounded-lg w-fit",children:[e.jsx("button",{onClick:()=>w("events"),className:`px-6 py-2 rounded-md font-medium transition-colors ${c==="events"?"bg-white text-primary-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Events"}),e.jsx("button",{onClick:()=>w("resumes"),className:`px-6 py-2 rounded-md font-medium transition-colors ${c==="resumes"?"bg-white text-primary-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Resumes"}),e.jsx("button",{onClick:()=>w("team"),className:`px-6 py-2 rounded-md font-medium transition-colors ${c==="team"?"bg-white text-primary-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Team"})]}),c==="events"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Manage Events"}),e.jsxs("button",{onClick:()=>m(!0),className:"btn-primary flex items-center",children:[e.jsx(q,{size:20,className:"mr-2"}),"Add Event"]})]}),e.jsx("div",{className:"grid gap-6",children:F.map(s=>e.jsx("div",{className:"card p-6",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:s.title}),e.jsxs("p",{className:"text-gray-600 mb-2",children:[S(s.date)," â€¢ ",s.location]}),e.jsx("p",{className:"text-gray-600 mb-4",children:s.description}),e.jsx("span",{className:`inline-block px-3 py-1 rounded-full text-sm font-medium ${s.status==="upcoming"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:s.status})]}),e.jsxs("div",{className:"flex space-x-2 ml-4",children:[e.jsx("button",{onClick:()=>{h(s),m(!0)},className:"p-2 text-gray-600 hover:text-primary-600",children:e.jsx(z,{size:18})}),s.status==="upcoming"&&e.jsx("button",{onClick:()=>{y(s),g(!0)},className:"p-2 text-gray-600 hover:text-orange-600",children:e.jsx(ee,{size:18})}),e.jsx("button",{onClick:()=>G(s.id),className:"p-2 text-gray-600 hover:text-red-600",children:e.jsx(D,{size:18})})]})]})},s.id))})]}),c==="resumes"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Resume Submissions"}),e.jsxs("div",{className:"relative",children:[e.jsx(se,{size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search resumes...",value:b,onChange:s=>B(s.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]}),e.jsx("div",{className:"grid gap-4",children:Q.map(s=>e.jsx("div",{className:"card p-6",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:s.name}),e.jsx("p",{className:"text-gray-600",children:s.email}),e.jsx("p",{className:"text-gray-600",children:s.phone}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Submitted: ",S(s.created_at)]})]}),e.jsxs("button",{onClick:()=>K(s.file_url,`${s.name}_resume.pdf`),className:"btn-primary flex items-center",children:[e.jsx(te,{size:18,className:"mr-2"}),"Download"]})]})},s.id))})]}),c==="team"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Manage Team"}),e.jsxs("button",{onClick:()=>u(!0),className:"btn-primary flex items-center",children:[e.jsx(q,{size:20,className:"mr-2"}),"Add Team Member"]})]}),e.jsx("div",{className:"grid gap-6",children:T.map(s=>e.jsx("div",{className:"card p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-16 h-16 mr-4",children:s.avatar_url?e.jsx("img",{src:s.avatar_url,alt:s.name,className:"w-full h-full object-cover rounded-full"}):e.jsx("div",{className:"w-full h-full bg-gray-200 rounded-full flex items-center justify-center",children:e.jsx(re,{size:24,className:"text-gray-400"})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:s.name}),e.jsx("p",{className:"text-purple-600 font-medium",children:s.title}),e.jsx("p",{className:"text-gray-600 mt-1",children:s.bio}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Order: ",s.order_index]})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>{p(s),u(!0)},className:"p-2 text-gray-600 hover:text-primary-600",children:e.jsx(z,{size:18})}),e.jsx("button",{onClick:()=>H(s.id),className:"p-2 text-gray-600 hover:text-red-600",children:e.jsx(D,{size:18})})]})]})},s.id))})]}),L&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-8 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:a?"Edit Event":"Add New Event"}),e.jsx("button",{onClick:()=>{m(!1),h(null)},className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(C,{size:24,className:"text-gray-500"})})]}),e.jsxs("form",{onSubmit:s=>{s.preventDefault(),W(new FormData(s.currentTarget))},children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Title *"}),e.jsx("input",{type:"text",name:"title",defaultValue:(a==null?void 0:a.title)||"",required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date *"}),e.jsx("input",{type:"date",name:"date",defaultValue:(a==null?void 0:a.date)||"",required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Location *"}),e.jsx("input",{type:"text",name:"location",defaultValue:(a==null?void 0:a.location)||"",required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description *"}),e.jsx("textarea",{name:"description",rows:4,defaultValue:(a==null?void 0:a.description)||"",required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Image URL"}),e.jsx("input",{type:"url",name:"image_url",defaultValue:(a==null?void 0:a.image_url)||"",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status *"}),e.jsxs("select",{name:"status",defaultValue:(a==null?void 0:a.status)||"upcoming",required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"upcoming",children:"Upcoming"}),e.jsx("option",{value:"past",children:"Past"})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-4 mt-8",children:[e.jsx("button",{type:"button",onClick:()=>{m(!1),h(null)},className:"btn-secondary",children:"Cancel"}),e.jsxs("button",{type:"submit",className:"btn-primary",children:[a?"Update":"Create"," Event"]})]})]})]})}),O&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-8 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:r?"Edit Team Member":"Add New Team Member"}),e.jsx("button",{onClick:()=>{u(!1),p(null),N(null)},className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(C,{size:24,className:"text-gray-500"})})]}),e.jsxs("form",{onSubmit:s=>{s.preventDefault(),X(new FormData(s.currentTarget))},children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Name *"}),e.jsx("input",{type:"text",name:"name",defaultValue:(r==null?void 0:r.name)||"",required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Title *"}),e.jsx("input",{type:"text",name:"title",defaultValue:(r==null?void 0:r.title)||"",required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bio *"}),e.jsx("textarea",{name:"bio",rows:4,defaultValue:(r==null?void 0:r.bio)||"",required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Avatar Image"}),e.jsx("input",{type:"file",accept:"image/*",onChange:s=>{var t;return N(((t=s.target.files)==null?void 0:t[0])||null)},className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),(r==null?void 0:r.avatar_url)&&e.jsx("div",{className:"mt-2",children:e.jsx("img",{src:r.avatar_url,alt:"Current avatar",className:"w-16 h-16 object-cover rounded-full"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Display Order"}),e.jsx("input",{type:"number",name:"order_index",defaultValue:(r==null?void 0:r.order_index)||0,min:"0",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-4 mt-8",children:[e.jsx("button",{type:"button",onClick:()=>{u(!1),p(null),N(null)},className:"btn-secondary",children:"Cancel"}),e.jsxs("button",{type:"submit",className:"btn-primary",children:[r?"Update":"Create"," Team Member"]})]})]})]})}),I&&x&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-8 max-w-md w-full mx-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Move Event to Past"}),e.jsx("button",{onClick:()=>{g(!1),y(null),v(null)},className:"p-1 hover:bg-gray-100 rounded transition-colors",children:e.jsx(C,{size:20,className:"text-gray-500"})})]}),e.jsxs("p",{className:"text-gray-600 mb-6",children:['Moving "',x.title,'" to past events. Please upload a blog file (Word or PDF).']}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Blog File (Word or PDF) *"}),e.jsx("input",{type:"file",accept:".docx,.pdf",onChange:s=>{var t;return v(((t=s.target.files)==null?void 0:t[0])||null)},required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx("button",{onClick:()=>{g(!1),y(null),v(null)},className:"btn-secondary",children:"Cancel"}),e.jsx("button",{onClick:J,disabled:!j,className:"btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:"Move to Past"})]})]})})]})})}export{oe as default};
